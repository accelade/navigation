const e={side:"left",collapsible:"offcanvas",variant:"sidebar",mobileBreakpoint:768,width:"17rem",widthIcon:"4.5rem",widthMobile:"18rem"},t={autoInit:!0,resizeDebounce:100,sidebarSelector:'[data-sidebar="sidebar"]',menuSelector:'[data-sidebar="menu"]',menuButtonSelector:'[data-sidebar="menu-button"]',triggerSelector:'[data-sidebar="trigger"]'},i=class i{constructor(i={}){this.initialized=!1,this.resizeTimeout=null,this.lastWindowWidth=0,this.previousState={open:!0,mobileOpen:!1},this.options={...t,...i},this.config={...e},this.lastWindowWidth="undefined"!=typeof window?window.innerWidth:0,this.options.autoInit&&this.init()}static getInstance(e){return i.instance||(i.instance=new i(e)),i.instance}static resetInstance(){i.instance&&(i.instance.destroy(),i.instance=null)}init(){this.initialized||(this.bindEvents(),this.setupAccessibility(),this.handleResize(),this.initialized=!0,this.dispatchEvent("navigation:ready",{manager:this}))}destroy(){this.resizeTimeout&&clearTimeout(this.resizeTimeout),this.initialized=!1}isInitialized(){return this.initialized}bindEvents(){document.addEventListener("keydown",this.handleKeyDown.bind(this)),window.addEventListener("resize",this.handleResizeEvent.bind(this)),this.setupMenuKeyboardNavigation()}handleKeyDown(e){"Escape"===e.key&&this.closeMobileSidebar()}handleResizeEvent(){this.resizeTimeout&&clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(()=>{this.handleResize()},this.options.resizeDebounce)}setupAccessibility(){document.querySelectorAll(this.options.sidebarSelector).forEach(e=>{e.hasAttribute("role")||e.setAttribute("role","navigation"),e.hasAttribute("aria-label")||e.setAttribute("aria-label","Main navigation")}),document.querySelectorAll(this.options.menuSelector).forEach(e=>{e.hasAttribute("role")||e.setAttribute("role","menu")}),document.querySelectorAll(this.options.menuButtonSelector).forEach(e=>{e.hasAttribute("role")||e.setAttribute("role","menuitem")})}handleResize(){const e=window.innerWidth,t=this.config.mobileBreakpoint;(this.lastWindowWidth<t&&e>=t||this.lastWindowWidth>=t&&e<t)&&e>=t&&this.closeMobileSidebar(),this.lastWindowWidth=e,this.updateSidebarDimensions()}updateSidebarDimensions(){const e=document.querySelector('[data-slot="sidebar-wrapper"]');if(!e)return;const t=getComputedStyle(e),i=t.getPropertyValue("--sidebar-width")||this.config.width,n=t.getPropertyValue("--sidebar-width-icon")||this.config.widthIcon,s=t.getPropertyValue("--sidebar-width-mobile")||this.config.widthMobile;e.style.getPropertyValue("--sidebar-width")||e.style.setProperty("--sidebar-width",i),e.style.getPropertyValue("--sidebar-width-icon")||e.style.setProperty("--sidebar-width-icon",n),e.style.getPropertyValue("--sidebar-width-mobile")||e.style.setProperty("--sidebar-width-mobile",s)}getStore(){const e=window.Accelade;if(e?.store)return e.store("sidebar")}closeMobileSidebar(){const e=this.getStore();if(e){const t=this.getState();e.$set("sidebarMobileOpen",!1),this.dispatchEvent("navigation:toggled",{open:!1,mobile:!0}),this.dispatchEvent("navigation:state-changed",{state:{...t,mobileOpen:!1},previousState:t})}}openMobileSidebar(){const e=this.getStore();if(e){const t=this.getState();e.$set("sidebarMobileOpen",!0),this.dispatchEvent("navigation:toggled",{open:!0,mobile:!0}),this.dispatchEvent("navigation:state-changed",{state:{...t,mobileOpen:!0},previousState:t})}}toggleSidebar(){const e=window.innerWidth<this.config.mobileBreakpoint,t=this.getStore();if(t){const i=this.getState();if(e){const e=!t.$get("sidebarMobileOpen");t.$set("sidebarMobileOpen",e),this.dispatchEvent("navigation:toggled",{open:e,mobile:!0})}else{const e=!t.$get("sidebarOpen");t.$set("sidebarOpen",e),this.dispatchEvent("navigation:toggled",{open:e,mobile:!1})}this.dispatchEvent("navigation:state-changed",{state:this.getState(),previousState:i})}}expandSidebar(){const e=this.getStore();if(e){const t=this.getState();e.$set("sidebarOpen",!0),this.dispatchEvent("navigation:toggled",{open:!0,mobile:!1}),this.dispatchEvent("navigation:state-changed",{state:{...t,open:!0},previousState:t})}}collapseSidebar(){const e=this.getStore();if(e){const t=this.getState();e.$set("sidebarOpen",!1),this.dispatchEvent("navigation:toggled",{open:!1,mobile:!1}),this.dispatchEvent("navigation:state-changed",{state:{...t,open:!1},previousState:t})}}isCollapsed(){const e=this.getStore();return!!e&&!e.$get("sidebarOpen")}isMobileOpen(){const e=this.getStore();return e&&e.$get("sidebarMobileOpen")||!1}isMobile(){return window.innerWidth<this.config.mobileBreakpoint}getState(){const e=this.getStore();return e?{open:e.$get("sidebarOpen")??!0,mobileOpen:e.$get("sidebarMobileOpen")??!1}:{open:!0,mobileOpen:!1}}setState(e){const t=this.getStore();if(t){const i=this.getState();void 0!==e.open&&t.$set("sidebarOpen",e.open),void 0!==e.mobileOpen&&t.$set("sidebarMobileOpen",e.mobileOpen),this.dispatchEvent("navigation:state-changed",{state:this.getState(),previousState:i})}}getConfig(){return{...this.config}}setConfig(e){this.config={...this.config,...e},this.updateSidebarDimensions()}setupMenuKeyboardNavigation(){document.addEventListener("keydown",e=>{const t=e.target.closest(this.options.menuButtonSelector);if(!t)return;const i=t.closest(this.options.menuSelector);if(!i)return;const n=Array.from(i.querySelectorAll(this.options.menuButtonSelector)),s=n.indexOf(t);this.handleMenuKeyNavigation(e,n,s)})}handleMenuKeyNavigation(e,t,i){switch(e.key){case"ArrowDown":e.preventDefault(),this.focusMenuItem(t,i+1,0);break;case"ArrowUp":e.preventDefault(),this.focusMenuItem(t,i-1,t.length-1);break;case"Home":e.preventDefault(),t[0]?.focus();break;case"End":e.preventDefault(),t[t.length-1]?.focus()}}focusMenuItem(e,t,i){const n=e[t]||e[i];n?.focus()}dispatchEvent(e,t){document.dispatchEvent(new CustomEvent(e,{detail:t,bubbles:!0}))}};i.instance=null;let n=i;function s(e){return n.getInstance(e)}document.addEventListener("accelade:navigated",()=>{window.AcceladeNavigation?.manager&&window.AcceladeNavigation.manager.setupAccessibility()}),function(){if(window.AcceladeNavigation)return;const e=()=>{const e=s();window.AcceladeNavigation={manager:e,toggle:()=>e.toggleSidebar(),expand:()=>e.expandSidebar(),collapse:()=>e.collapseSidebar(),getState:()=>e.getState(),isCollapsed:()=>e.isCollapsed(),isMobile:()=>e.isMobile(),version:"0.1.0"},document.dispatchEvent(new CustomEvent("navigation:ready",{detail:{manager:e}}))};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",e):e()}();export{n as NavigationManager,s as initNavigation};
//# sourceMappingURL=navigation.esm.js.map
